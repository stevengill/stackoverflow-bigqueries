#standardSQL
#
# This query operates on the GitHub data set and attempts to find all committers that have committed in a specified time period (line 28)
# to a number of GitHub repositories (line 28, ff). The query will then determine the percentile rank for each committer according to the
# number of committs made and the number of repositories affected. The query then determines the euclidian distance of the two measures
# and ranks by it. In short, it finds the people that have made lots of committs to lots of repository, where the definition of lots is
# dependent on what this committers peers have done.
#
#
SELECT
  author,
  LOWER(author) AS shahash,
  PERCENT_RANK() OVER (ORDER BY commits DESC) AS crank,
  PERCENT_RANK() OVER (ORDER BY repos DESC) AS rrank,
  repos,
  commits,
  SQRT((PERCENT_RANK() OVER (ORDER BY commits DESC)*PERCENT_RANK() OVER (ORDER BY commits DESC))+(PERCENT_RANK() OVER (ORDER BY repos DESC)*PERCENT_RANK() OVER (ORDER BY repos DESC))) AS orank
  FROM (
  SELECT
    author.name AS author, 
    COUNT(DISTINCT REGEXP_REPLACE(repo_name,".*/","")) AS repos, 
    COUNT(commit) AS commits
  FROM 
    `bigquery-public-data.github_repos.commits` AS c
  LEFT JOIN
    c.repo_name
  WHERE
    EXTRACT(YEAR FROM author.date) > 2015 AND repo_name IN("Adobe-CloudOps/Adobe-Chef",
      "Adobe-Consulting-Services/acs-aem-commons",
      "Adobe-Consulting-Services/acs-aem-samples",
      "Adobe-Consulting-Services/acs-aem-tools",
      "Adobe-Consulting-Services/adobe-consulting-services.github.io",
      "Adobe-Consulting-Services/aem-chrome-plugin",
      "Adobe-Consulting-Services/aemcasts",
      "Adobe-Consulting-Services/checkstyle-osgi-checks",
      "Adobe-Consulting-Services/coding-standards",
      "Adobe-Consulting-Services/com.adobe.acs.bundles.gson",
      "Adobe-Consulting-Services/com.adobe.acs.bundles.netty",
      "Adobe-Consulting-Services/com.adobe.acs.bundles.retrofit",
      "Adobe-Consulting-Services/com.adobe.acs.bundles.sling-healthcheck",
      "Adobe-Consulting-Services/com.adobe.acs.bundles.sling-models",
      "Adobe-Consulting-Services/com.adobe.acs.bundles.twitter4j",
      "Adobe-Consulting-Services/lazybones-aem-templates",
      "Adobe-Digital-Composites/Digital-Composites-ObjC",
      "Adobe-Marketing-Cloud/adobe-marketing-cloud.github.io",
      "Adobe-Marketing-Cloud/aem-communities-ugc-migration",
      "Adobe-Marketing-Cloud/aem-core-wcm-components",
      "Adobe-Marketing-Cloud/aem-demo-machine",
      "Adobe-Marketing-Cloud/aem-htl-repl",
      "Adobe-Marketing-Cloud/aem-project-archetype",
      "Adobe-Marketing-Cloud/aem-sample-we-retail",
      "Adobe-Marketing-Cloud/aem-sample-we-retail-commons",
      "Adobe-Marketing-Cloud/aem-sample-we-retail-communities",
      "Adobe-Marketing-Cloud/aem-scf-sample-components-extension",
      "Adobe-Marketing-Cloud/aem-sites-example-custom-template-type",
      "Adobe-Marketing-Cloud/aem-translation-framework-bootstrap-connector",
      "Adobe-Marketing-Cloud/analytics-data-workbench-samples",
      "Adobe-Marketing-Cloud/analytics-java-library",
      "Adobe-Marketing-Cloud/analytics-realtime-dashboard-example",
      "Adobe-Marketing-Cloud/analytics-samples",
      "Adobe-Marketing-Cloud/experiencemanager-clientcontext-samples",
      "Adobe-Marketing-Cloud/experiencemanager-java-designimporter",
      "Adobe-Marketing-Cloud/experiencemanager-java-msmrollout",
      "Adobe-Marketing-Cloud/experiencemanager-seo-extensions",
      "Adobe-Marketing-Cloud/experiencemanager-workflow-samples",
      "Adobe-Marketing-Cloud/htl-spec",
      "Adobe-Marketing-Cloud/htl-tck",
      "Adobe-Marketing-Cloud/mobile-services",
      "Adobe-Marketing-Cloud/python-pandas-lab",
      "Adobe-Marketing-Cloud/target-atjs-extensions",
      "Adobe-Marketing-Cloud/test-cross-platform",
      "Adobe-Marketing-Cloud/tools",
      "Adobe-Marketing-Cloud/video-heartbeat-v2",
      "Adobe-Marketing-Cloud/visitor-server-sample-app",
      "adobe-apiplatform/api-gateway-async-logger",
      "adobe-apiplatform/api-gateway-aws",
      "adobe-apiplatform/api-gateway-cachemanager",
      "adobe-apiplatform/api-gateway-config-supervisor",
      "adobe-apiplatform/api-gateway-hmac",
      "adobe-apiplatform/api-gateway-request-tracking",
      "adobe-apiplatform/api-gateway-request-validation",
      "adobe-apiplatform/api-gateway-zmq-adaptor",
      "adobe-apiplatform/api-gateway-zmq-logger",
      "adobe-apiplatform/apigateway",
      "adobe-apiplatform/apigateway-examples",
      "adobe-apiplatform/echo-service",
      "adobe-apiplatform/micro-service-container",
      "adobe-apiplatform/openwhisk-hello-package",
      "adobe-apiplatform/sync-tool.py",
      "adobe-apiplatform/umapi-client.py",
      "adobe-apiplatform/umapi-sdk.py",
      "adobe-digital-imaging/Fluid",
      "adobe-flash/Webkit4AIR",
      "adobe-flash/avmplus",
      "adobe-flash/crossbridge",
      "adobe-flash/graphicscorelib",
      "adobe-fonts/adobe-blank",
      "adobe-fonts/adobe-blank-2",
      "adobe-fonts/adobe-notdef",
      "adobe-fonts/adobe-variable-font-prototype",
      "adobe-fonts/atf-localized-ss-names",
      "adobe-fonts/css-orientation-test",
      "adobe-fonts/fdarray-test",
      "adobe-fonts/ivs-test",
      "adobe-fonts/kenten-generic",
      "adobe-fonts/locl-test",
      "adobe-fonts/source-bengali-sans",
      "adobe-fonts/source-code-pro",
      "adobe-fonts/source-devanagari-sans",
      "adobe-fonts/source-emoji",
      "adobe-fonts/source-gujarati-sans",
      "adobe-fonts/source-gurmukhi-sans",
      "adobe-fonts/source-han-code-jp",
      "adobe-fonts/source-han-sans",
      "adobe-fonts/source-hebrew-sans",
      "adobe-fonts/source-kannada-sans",
      "adobe-fonts/source-sans-pro",
      "adobe-fonts/source-serif-pro",
      "adobe-fonts/source-tamil-sans",
      "adobe-fonts/tombo-sp",
      "adobe-fonts/width-test",
      "adobe-photoshop/adobe-photoshop.github.io",
      "adobe-photoshop/generator-assets",
      "adobe-photoshop/generator-assets-automation",
      "adobe-photoshop/generator-cli",
      "adobe-photoshop/generator-connection",
      "adobe-photoshop/generator-core",
      "adobe-photoshop/generator-getting-started",
      "adobe-photoshop/generator-panels",
      "adobe-photoshop/generator-spaces",
      "adobe-photoshop/generator-weblogger",
      "adobe-photoshop/spaces-adapter",
      "adobe-photoshop/spaces-design",
      "adobe-photoshop/ws",
      "adobe-research/ActionScript4",
      "adobe-research/GCview",
      "adobe-research/audio-retargeting",
      "adobe-research/azure-quickstart-templates",
      "adobe-research/brackets",
      "adobe-research/cross-preferences",
      "adobe-research/fondue",
      "adobe-research/http_streaming_client",
      "adobe-research/libkafka",
      "adobe-research/livy",
      "adobe-research/mesh",
      "adobe-research/mississippi",
      "adobe-research/node-theseus",
      "adobe-research/prometheus-opentsdb-exporter",
      "adobe-research/spark-cluster-deployment",
      "adobe-research/spark-gpu",
      "adobe-research/spark-parquet-thrift-example",
      "adobe-research/spindle",
      "adobe-research/stream_consumer",
      "adobe-research/svgObjectModelGenerator",
      "adobe-research/theseus",
      "adobe-research/video-lecture-summaries",
      "adobe-security/Malware-classifier",
      "adobe-sign/AdobeSignJavaSdk",
      "adobe-sign/AdobeSignJsSdk",
      "adobe-webplatform/Demo-for-Alice-s-Adventures-in-Wonderland",
      "adobe-webplatform/Demo-for-Food-Network-Cupcakes",
      "adobe-webplatform/Demo-for-National-Geographic-Forest-Giant",
      "adobe-webplatform/Demo-for-National-Geographic-Orphan-Elephants",
      "adobe-webplatform/Demo-for-PBS-Kids-Word-Girl",
      "adobe-webplatform/Snap.svg",
      "adobe-webplatform/balance-text",
      "adobe-webplatform/brackets-css-shapes-editor",
      "adobe-webplatform/cdnjs",
      "adobe-webplatform/coding-guidelines",
      "adobe-webplatform/css-regions-polyfill",
      "adobe-webplatform/css-shapes-editor",
      "adobe-webplatform/css-shapes-polyfill",
      "adobe-webplatform/csswg-test",
      "adobe-webplatform/custom-filters-demo-travel-app",
      "adobe-webplatform/dr.js",
      "adobe-webplatform/dropcap.js",
      "adobe-webplatform/eve",
      "adobe-webplatform/exclusionsrecipe",
      "adobe-webplatform/html5devconf-2013",
      "adobe-webplatform/iframeflow.js",
      "adobe-webplatform/regions-adaptive",
      "adobe-webplatform/road-trip",
      "adobe-webplatform/screensaver",
      "adobe-webplatform/shaderdsl",
      "adobe-webplatform/transform-tests",
      "adobe/CodeMirror2",
      "adobe/GLS3D",
      "adobe/SimpleTable",
      "adobe/Spry",
      "adobe/WebkitAIR",
      "adobe/adobe.github.com",
      "adobe/angle",
      "adobe/avmplus",
      "adobe/brackets",
      "adobe/brackets-app",
      "adobe/brackets-edge-web-fonts",
      "adobe/brackets-phonegap",
      "adobe/brackets-shell",
      "adobe/brackets-updates",
      "adobe/brackets.io",
      "adobe/chromium",
      "adobe/creative-sdk",
      "adobe/css-pseudo-elements",
      "adobe/cssfilterlab",
      "adobe/dds2atf",
      "adobe/edge-hub",
      "adobe/flash-platform",
      "adobe/glsl2agal",
      "adobe/graphicalweb-keynote",
      "adobe/iphone-filter-demo",
      "adobe/node-smb-server",
      "adobe/skia",
      "adobe/telemetry-utils",
      "adobe/web-platform",
      "adobe/webkit",
      "apache/cordova",
      "apache/cordova-amazon-fireos",
      "apache/cordova-android",
      "apache/cordova-app-harness",
      "apache/cordova-app-hello-world",
      "apache/cordova-bada",
      "apache/cordova-bada-wac",
      "apache/cordova-blackberry",
      "apache/cordova-browser",
      "apache/cordova-cli",
      "apache/cordova-coho",
      "apache/cordova-common",
      "apache/cordova-create",
      "apache/cordova-docs",
      "apache/cordova-electron",
      "apache/cordova-fauxton-server",
      "apache/cordova-fetch",
      "apache/cordova-firefoxos",
      "apache/cordova-ios",
      "apache/cordova-js",
      "apache/cordova-labs",
      "apache/cordova-lib",
      "apache/cordova-medic",
      "apache/cordova-mobile-spec",
      "apache/cordova-osx",
      "apache/cordova-paramedic",
      "apache/cordova-plugin-battery-status",
      "apache/cordova-plugin-camera",
      "apache/cordova-plugin-compat",
      "apache/cordova-plugin-console",
      "apache/cordova-plugin-contacts",
      "apache/cordova-plugin-device",
      "apache/cordova-plugin-device-motion",
      "apache/cordova-plugin-device-orientation",
      "apache/cordova-plugin-dialogs",
      "apache/cordova-plugin-file",
      "apache/cordova-plugin-file-transfer",
      "apache/cordova-plugin-geolocation",
      "apache/cordova-plugin-globalization",
      "apache/cordova-plugin-inappbrowser",
      "apache/cordova-plugin-legacy-whitelist",
      "apache/cordova-plugin-media",
      "apache/cordova-plugin-media-capture",
      "apache/cordova-plugin-network-information",
      "apache/cordova-plugin-screen-orientation",
      "apache/cordova-plugin-splashscreen",
      "apache/cordova-plugin-statusbar",
      "apache/cordova-plugin-test-framework",
      "apache/cordova-plugin-vibration",
      "apache/cordova-plugin-whitelist",
      "apache/cordova-plugin-wkwebview-engine",
      "apache/cordova-plugins",
      "apache/cordova-plugman",
      "apache/cordova-qt",
      "apache/cordova-registry",
      "apache/cordova-registry-web",
      "apache/cordova-serve",
      "apache/cordova-template-reference",
      "apache/cordova-tizen",
      "apache/cordova-ubuntu",
      "apache/cordova-webos",
      "apache/cordova-weinre",
      "apache/cordova-windows",
      "apache/cordova-wp7",
      "apache/cordova-wp8",
      "apache/felix",
      "apache/jackrabbit",
      "apache/jackrabbit-oak",
      "apache/oltu",
      "apache/sling",
      "openwhisk/openwhisk",
      "phonegap/ios-deploy",
      "phonegap/ios-sim",
      "phonegap/phonegap",
      "phonegap/phonegap-app-anyconference",
      "phonegap/phonegap-app-augmented-reality",
      "phonegap/phonegap-app-desktop",
      "phonegap/phonegap-app-developer",
      "phonegap/phonegap-app-pgb",
      "phonegap/phonegap-app-star-track",
      "phonegap/phonegap-cli",
      "phonegap/phonegap-docs",
      "phonegap/phonegap-es6-promise",
      "phonegap/phonegap-intellij-plugin",
      "phonegap/phonegap-mobile-accessibility",
      "phonegap/phonegap-plugin-barcodescanner",
      "phonegap/phonegap-plugin-contentsync",
      "phonegap/phonegap-plugin-fast-canvas",
      "phonegap/phonegap-plugin-multiview",
      "phonegap/phonegap-plugin-push",
      "phonegap/phonegap-plugin-template",
      "phonegap/phonegap-plugins",
      "phonegap/phonegap-sample-hybrid-android",
      "phonegap/phonegap-start",
      "phonegap/phonegap-template-framework7",
      "phonegap/phonegap-template-hello-world",
      "phonegap/phonegap-template-react-hot-loader",
      "phonegap/phonegap-template-webvr",
      "phonegap/phonegap-webview-ios",
      "phonegap/phonegap.github.io",
      "phonegap/workshop-plugins",
      "topcoat/beta",
      "topcoat/button",
      "topcoat/button-bar",
      "topcoat/button-bar-base",
      "topcoat/design",
      "topcoat/fonts",
      "topcoat/grid",
      "topcoat/grunt-topcoat",
      "topcoat/icon-button",
      "topcoat/icons",
      "topcoat/list",
      "topcoat/list-base",
      "topcoat/navigation-bar",
      "topcoat/navigation-bar-base",
      "topcoat/primer",
      "topcoat/resin",
      "topcoat/root",
      "topcoat/select",
      "topcoat/select-base",
      "topcoat/tab-bar",
      "topcoat/topcoat",
      "topcoat/topcoat-effeckt",
      "topcoat/topcoat.github.com",
      "topcoat/topdoc-template",
      "topcoat/variables",
      "topcoat/variables-dark",
      "topcoat/variables-desktop",
      "topcoat/variables-light",
      "topcoat/variables-mobile",
      "topcoat/variables-shared",
      "typekit/fvd",
      "typekit/mysql-inspector",
      "typekit/platform-demo-browse",
      "typekit/slackbot",
      "typekit/speakeasy",
      "typekit/typekit-api-examples",
      "typekit/webfontloader")
  GROUP BY
  author)
ORDER BY
orank ASC